---
title: The BioDT Recreational Potential Model
subtitle: Summary
authors:
  - name: Joe Marsh Rossney
    orcid: 0000-0002-8082-8566
    affiliation: UK Centre for Ecology & Hydrology
  - name: Maddalena Tigli
    orcid: 0000-0001-8083-0589
  - name: Chris Andrews
  - name: Jan Dick
  - name: Simon Rolph

date: today
date-format: long
abstract: >
  These documents collectively describe the xyz.

citation: true
license: CC BY
funding: This work was funded by BioDT
---

## Background

TODO Brief history of recreational potential work, with references

ESTIMAP (“Ecosystem Service Mapping Tool”) is a collection of spatially explicit models, originally developed to support policies at a European scale [@Zulian2013; @Paracchini2014;  @Zulian2018].

[OpenNESS project](https://oppla.eu/groups/openness/openness-project) 2012-2017 [@Zulian2018]. (note www.openness-project.eu has been abandoned)

Something something _Long Term Socio-Ecological Research Platforms_ (LTSER) [@Dick2018]

BioDT project 2022-2025, outputs include [@Rolph2024; @Dick2025b]. 

SPEAK has something to do with Powell2024 ?

TODO Brief introduction to BioDT, the CES project and the recreational potential component. [@Dick2022; @Rolph2024]


The BioDT consortium ... 
As a member of this
Cultural Ecosystem Services (CES) 
Digital Twin (DT).

The CES DT was imagined as a platform that brings together near real time data from a wide range of sources in a manner that is somehow tailored to the individual user. The proposed pDT focuses on two components:

1. **Recreational Potential (RP)** - the capacity of an area to sustain the recreational activities valuable to an individual user
2. **Biodiversity** - the xyz

The rationale behind bringing these two components together into a unified framework was that for many people, encountering interesting flora or fauna can enrich their recreational experience and help them to value the ecosystem... ?

The driving motivation for this work is to promote good health and connection to nature through physical activity outdoors. However, there is also a possible synergy with conservation science, which are increasingly using data collected by non-scientists through 'citizen science' apps such as iNaturalist and xyz. Potentially, certain users could be encouraged to visit areas where there is a greater need for sampling.

The RP component and the biodiversity component are distinct models that have been developed independently of each other. However, in both cases their output is simple a collection of raster layers, which can be manipulated, combined and displayed in the front-end app.

Earlier on in the BioDT project, rudimentary versions of the RP and biodiversity components were combined in a single raster overlay. However, this was limited to pre-calculated 'static' raster layers covering a small region (the Cairngorms National Park) rather than all of Scotland @Rolph2024.

Since then, work has focused on improving the speed and scalability of these components, to enable the interactive and personalisable ...

In this short report we will describe basic aspects of the Recreational Potential model. For a detailed account of the inner workings of the model the reader is directed to the accompanying [technical supplement](tech_supp.html).

### 1. Scope of the Model

The **recreational potential model** (RP Model) was developed as part of the *Cultural Ecosystem Services prototype Digital Twin (CES-pDT)* workpackage within the [BioDT](https://biodt.eu/) project. The *([CES-pDT](https://app.biodt.lifewatch.eu/app_proxy/b6d219cf-f46c-4ef5-a517-e9a7289f81fa/?_inputs_&app-navbar=%22CES%22#tab-6956-4))* has two [independent]{.underline} core models:

-   the Biodiversity model (developed by Simon Rolph and Dylan Carbone, UK Centre for Ecology & Hydrology, Wallingford, United Kingdom): aims *at estimating biodiversity levels across mammals, birds, plant and insects.*

-   the Recreational Potential model (developed by Jan Dick, Chris Andrews, Maddalena Tigli, Megan Williams and Joe Marsh Rossney, UK Centre for Ecology & Hydrology, Edinburgh, United Kingdom): aims at *estimating the landscapes' capacity to provide opportunities for outdoor recreation based on varying user interests.*

This report specifically documents the Recreational Potential (RP) Model, detailing its methodology, data sources, operational mechanisms, and outlining areas for future refinement and development.

**CHRISTOPHER TO ADD MORE INFO? MAYBE THERE ARE SOME LIT SOURCES USED?**

## Model description

The output of the Recreational Potential (RP) model is an two-dimensional array of numbers (a _raster_) representing an RP value for each 20x20 metre square area of land (_pixel_) within a given area.

A single RP value is made up of 87 _items_ representing distinct attributes of the land. The 87 items are grouped into four _components_:

- **_Landscape_** - the suitability of land to support recreational activity.
- **_Natural Features_** influencing the potential.
- **_Infrastructure_** features influencing the potential.
- **_Water_** - rivers and lakes.

An RP value is calculated by weighting each item by a _score_ that reflects the importance of that item to the user. A full set of 87 scores is referred to as a _persona._

The RP model requires two inputs from users:

1. A persona
2. An area (within Scotland) in which to calculate RP

Given these inputs, the model computes an RP value for each 20x20 metre square of land within the area specified, with higher values indicating greater Recreational Potential for that specific persona.

The values are rescaled so that they fall between zero and one. They can then be mapped to colours and displayed as a _heat map_ over a map of Scotland.

TODO: screenshot

The input data for the RP model are a collection of 87 raster layers for each of the 87 items, covering Scotland at a resolution of 20x20m.

For items belonging to the *Landscape* component or the *Natural Features* component, these rasters contain just ones and zeros, with $1$ indicating presence of the feature in that pixel and $0$ indicating absence.

For items belonging to the _Infrastructure_ component or the _Water_ component, the input rasters contain values _between_ zero and one. Here, $1$ still indicates presence of the feature in that pixel, but $0$ instead indicates that the feature is not only absent in that pixel, but all surrounding pixels within a certain distance. The range of values between zero and one are used to signify that the feature is nearby, but not present in this pixel itself. Higher values correspond to the feature being closer.

### 2.1. Model description

```{mermaid}
flowchart LR
 subgraph s1["compute recreational potential"]
        C[("cropping of the 4<br>components file to the<br>extent of interest")]
        E["Compute each component's<br>contribution"]
        F["Rescale to unit interval"]
  end
    A("Definition of the<br><i>persona preferences</i>") ---> E
    B("Definition of the<br><i>area of interest</i>") --> C
    C --> E
    E --> F
    F --> G["recreational potential spatRast"]
    style s1 fill:#FFF9C4
    style A color:#000000
    style B color:#000000
    style C color:#000000
    style E color:#000000
    style F color:#000000
    style G color:#000000
```

The Recreational Potential (RP) Model estimates the recreational value of landscapes using four key components, each represented by a raster file:

1.  Landscape Component (SLSRA.tif)

2.  Natural Features Component (FIPS_N.tif)

3.  Infrastructure Component (FIPS_I.tif)

4.  Water Component (Water.tif)

Each of the four component raster files contains multiple layers, with each layer representing a specific feature. Each raster covers the entire domain of the model (with a 20mx20m resolution), currently Scotland (see [2.3. The underlying data]).

The values in these raster layers range from 0 to 1, interpreted as follows:

-   1 indicates that the feature is present in that cell.

-   0 or NAs indicates that the feature is absent from that cell

-   Values between 0 and 1 are present in the features/layers of the Infrastructure and Water components rasters, and reflect the proximity from nearby features. This continuous scale allows the RP model to incorporate how areas near e.g., a loch, can still contribute to the recreational potential, even if they do not directly contain the feature

The four rasters form the basis for calculating the Recreational Potential (RP) across the landscape.

To run the RP model the user must define:

-   Area of interest: defined using a bounding box ([terra::ext()](https://www.rdocumentation.org/packages/terra/versions/0.8-6/topics/extent) in R).

-   Persona preferences: a CSV file assigning a score (0–10) to each of the 87 features (see [2.3. The underlying data]), reflecting the persona's interest in each (see example persona file "presets.csv" ).

#### RP model processing steps

1.  **Cropping the raster files**

The model first crops each of the four component rasters to the specified area of interest. Using the terra package in R, the bounding box is converted to a vector polygon with terra::vect(), and then used to crop the raster via terra::crop().

2.  **Calculating each components contribution**

For each cell (20m x 20m), the model extracts values from all relevant layers (features), multiplies them by the corresponding persona score, and computes a weighted sum across layers. This results in one new raster per component that reflects the component’s contribution based on the persona preferences.

3.  **Re-scale to unit interval**

Each of the components contribution rasters is re-scaled using "min-max normalization":

$$
scaled.value = (x-min)/mix-min
$$

Minimum values are mapped as 0, maximum values are mapped as 1, and all the intermediate values are proportionally scaled.

4.  **Combining the components RP**

The four normalized component rasters are summed cell by cell. The resulting raster is then re-scaled again (min-max normalization) to produce the final Recreational Potential raster.

The model's output is a SpatRaster object (that can be saved as a .tif) with five layers:

1.  "SLSRA": the RP of the landscape component

2.  "FIPS_N": the RP of the natural features component

3.  "FIPS_I": the RP of the infrastructure component

4.  "Water": the RP of the water component

5.  "Recreational_Potential": the combined RP

In all layers, values range from 0 to 1, where higher values (closer to 1) indicate greater recreational potential.

Because the model output is a result of the normalization of recreational potential of a specific area of interest, the values are relative within that area. This means that running the model with a different geographic extent will yield to different scores for the same features, even if the underlying data is unchanged.

### 2.2. Example run

```{r, echo=FALSE}
library(magrittr)
library(biodt.recreation)

source("functions_report.R")

water <- terra::rast(system.file("extdata", "rasters", "Bush", "original", "Water.tif", package="biodt.recreation"))

slsra <- terra::rast(system.file("extdata", "rasters", "Bush", "SLSRA.tif", package="biodt.recreation"))

fips_n <- terra::rast(system.file("extdata", "rasters", "Bush", "FIPS_N.tif", package="biodt.recreation"))

fips_i <- terra::rast(system.file("extdata", "rasters", "Bush", "original", "FIPS_I.tif", package="biodt.recreation"))



# the box of bush estate
e <- terra::ext(water)
coords <- matrix(c(
  e$xmin, e$ymin,
  e$xmax, e$ymin,
  e$xmax, e$ymax,
  e$xmin, e$ymax,
  e$xmin, e$ymin # close polygon
), ncol = 2, byrow = TRUE)
bbox_poly <- terra::vect(coords,
  type = "polygons",
  crs = terra::crs(water)
) %>%
  sf::st_as_sf() %>%
  sf::st_transform(crs = 4326)

base_map <- 
  leaflet::leaflet() %>%
  leaflet::addProviderTiles("OpenStreetMap.Mapnik", options = leaflet::providerTileOptions(zIndex = 0, noWrap = TRUE), group = "Streets") %>%
  leaflet::addProviderTiles("Esri.WorldImagery", options = leaflet::providerTileOptions(zIndex = 0, noWrap = TRUE), group = "Satellite") %>%
  leaflet::addPolygons(
    data = bbox_poly,
    color = "black",
    weight = 3,
    fill = FALSE
  ) 

```

We demonstrate the RP Model applied to the Bush Estate area (nearby Edinburgh) using two contrasting personas: a hard recreationalist and a soft recreationalist. The resulting maps illustrate how different preferences lead to different areas being highlighted for recreational value.

1.  **Hard recreationalist exmaple**

Here we show a model run the Bush Estate area using a "hard recreationalist" example of persona (saved as "Hard_Recreationalist" in "presets.csv" ). Key features preferences for this persona are:

```{r, echo=FALSE, message=FALSE}

hard_recr <- 
  data.frame(get_example_persona())%>%
  tibble::rownames_to_column(var = "Name")%>%
  dplyr::select(Name,
                Score = `get_example_persona..`)

meaningful_scores <- summarise_persona_scores(hard_recr)
  
knitr::kable(meaningful_scores,format = "html",
             caption = "Features scored the highest and the lowest in the hard recreationalist persona")
```

This persona highly values remote, challenging environments and avoids built-up or highly managed areas.

```{r, echo=FALSE, warning=FALSE, results='hide', message = FALSE}
hard_recreationalist <- get_example_persona()
bush_estate <- get_example_bbox()
data_dir <- get_example_data_dir()

# Compute all layers
layers_HR <- compute_potential(hard_recreationalist,
                            bush_estate,
                            data_dir)
```

```{r, echo=FALSE }
build_rp_map(base_map, RP_output = layers_HR)
```

2.  **Soft recreationalist example**

Here we show a model run the Bush Estate area using a "soft recreationalist" example of persona (saved as "Soft_Recreationalist" in "presets.csv"). Key features preferences for this persona are:

```{r, echo=FALSE}

soft_recr <- 
  read.csv(system.file("extdata", "personas", "presets.csv", package="biodt.recreation")) %>%
  dplyr::select(Name = index,
                Score = Soft_Recreationalist)

meaningful_scores <- summarise_persona_scores(soft_recr)
  
knitr::kable(meaningful_scores,format = "html",
             caption = "Features scored the highest and the lowest in the soft recreationalist persona")
```

Soft recreationalists are drawn to tranquil, accessible landscapes and natural water features, avoiding steep or harsh terrain.

```{r, echo=FALSE, warning=FALSE, results='hide', message = FALSE}
soft_recreationalist <- 
  load_persona(get_preset_persona_file(), "Soft_Recreationalist")
  
# Compute all layers
layers_SR <- compute_potential(soft_recreationalist,
                            bush_estate,
                            data_dir)
```

```{r, echo=FALSE}
build_rp_map(base_map, RP_output = layers_SR)
```


## Overview of the code

Source code for the most up-to-date version of the RP model can be found on GitHub at https://github.com/BioDT/uc-ces-recreation.

The code is bundled as an `R` _package_. This has a number of advantages compared with a stand-alone script, such as the ability to ... through a standardised installation procedure that ...

In practical terms, this means the functionality is provided through a collection of _functions_ that, after installing the package, are accessible to the user using the syntax `package::function`. the `biodt.recreation` namespace using the 

Along with these functions, the package contains 

- A **license** (following other BioDT projects, we used the MIT license).
- **Documentation**, which renders nicely in IDEs such as RStudio.
- **Vignettes** - examples showcasing use of the package.
- **Metadata** including the code authors and the version number of the package.
- A list of **dependencies**, i.e. other `R` packages that `biodt.recreation` requires to work. Installing `biodt.recreation` using standard tools will also automatically install these dependencies.

### Development timeline

- TODO Originally copied from someone else's python model?

The RP model for Scotland has been gradually developed within UKCEH over a number of years, with various contributors.

- TODO When was the calibration etc done?
- Add SPEAK study

| Time period   | Activity         | Contributors                       | Relevant links                                                                                                                                                   |
| ------------- | ---------------- | ---------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2023          | Code development | Will Bolton, Chris Andrews         | https://github.com/BioDT/uc-ces/tree/main/recreation_model                                                                                                       |
| 2024          |                  | Chris Andrews, Maddalena Tigli     | https://github.com/BioDT/uc-ces-recreation/tree/2024-model                                                                                                       |
| Jan-June 2025 |                  | Joe Marsh Rossney, Maddalena Tigli | Version used in SPEAK study: https://github.com/BioDT/uc-ces-recreation/tree/SPEAK-prerelease<br>Development version: https://github.com/BioDT/uc-ces-recreation |

- TODO Link to Zenodo


### Production of input data



The 'raw' data is downloaded from various locations (TODO - Chris).
There is then a series of processing steps to transform it into the form needed for the RP model.

In an ideal world this data production 'pipeline' would be entirely automated through one or more scripts. This would enable the input data to be more easily regenerated / updated in future.


This data is currently stored on DropBox, but will be moved to Zenodo.

### Recreational Potential calculation

For SLSRA and FIPS_N features, $f_{ij}(x, y)$ is either zero, indicating absence of the feature in that pixel, or one, indicating presence.

For the Landscape (`SLSRA`) and Natural Features (`FIPS_N`) components, the input rasters are binary-valued presence/absence rasters,

$$
\mathrm{SLSRA}_j = \begin{cases}
1 & \text{if feature} \; j \; \text{present in pixel} \\
0 & \text{if feature} \; j \; \text{absent in pixel}  \, .
\end{cases}
$$

For the Infrastructure (`FIPS_I`) and Water (`Water`) components, there is an additional 'proximity' contribution from nearby pixels containing the feature. The input rasters are therefore


$$
\mathrm{Water}_j = \begin{cases}
1 & \text{if feature} \; j \; \text{present in pixel} \\
0 & \text{if feature} \; j \;\gtrapprox 500\text{m away} \\
u(\mathrm{distance}_j \,; \alpha, \kappa) & \text{otherwise}
\end{cases}
$$

where $\mathrm{distance}_j$ is the distance to the nearest pixel in which the feature $j$ is present, and $u( \cdot \,; \kappa, \alpha)$ is a function that outputs values between 1 and 0, decreasing as $d$ increases. 

Each component is calculated by multiplying the item/feature layers by the corresponding persona score, summing, and normalising the result so that it lies between 0 and 1,

$$
\mathrm{SLSRA} = \mathrm{normalise}\left\{ \sum_j \mathrm{Score}_j \times \mathrm{SLSRA}_j \right\} \, .
$$

The final RP value is calculated by summing these four components and normalising once more,

$$
\mathrm{RP} = \mathrm{normalise} \left\{ \mathrm{SLSRA} + \mathrm{FIPS\_N} + \mathrm{FIPS\_I} + \mathrm{Water} \right\} \, .
$$

### Interactive app

- TODO: How to access the app on DataLabs and run it

- TODO: how to run it locally

However, the essential steps are: (i) create a persona using the 'Persona' tab, (ii) draw a box on the map using the square orange button, and finally (iii) click the 'Update Map' button to compute the Recreational Potential value.

## Basic usage

These instructions cover setup and basic usage of the RP model.

It is assumed that the user is familiar with the following:

- Installing `R` packages
- Executing lines of `R` code in interactive sessions
- Running `R` scripts

More detailed instructions for developers can be found in the [`README.md`](https://github.com/BioDT/uc-ces-recreation/blob/main/README.md) file in the repository.

### Prerequisites

- R version 4.4.x
- Ensure you have either `remotes` or `devtools` installed (using e.g. `install.packages` or `renv::install`)
- It is recommended to perform the following steps using an R envirnoment managed by [`renv`](https://rstudio.github.io/renv/)
- There are certain C++ libraries that are required by the R packages, and need to be installed on the system. Most importantly is the GDAL library.
### Installation

1. Install the package:

```R
remotes::install_github("BioDT/uc-ces-recreation")
```

2. Download the data:

```R
biodt.recreation::download_data()
```

### Usage

3. Run the app:

```R
biodt.recreation::run_app()
```

4. Use the package in a script

```R
library(terra)
library(biodt.recreation)

persona <- load_persona("path/to/my_persona.csv", "Running")
bbox <- ext(xmin, xmax, ymin, ymax)

layers <- compute_potential(persona, bbox)

plot(layers$Recreational_Potential)
```

### Documentation

TODO


## Discussion

- The model is very fast and embarrassingly parallel - therefore can scale very well, to large areas and/or high resolutions.
- However, the use-case for large areas is unclear, and the resolution depends on the datasets being used.

- The data production pipeline could be improved:
	- Fully automated / scripted would allow easier updating with more / updated datasets
	- Also reproducibility and transparency of how the data was produced (many users wanted to know more about the input data)

 - Use of rasters is a problem for linear features
	 - Use vector layers for linear features and distance
	 - This would also make data production easier

- Digital twin?

## Funding {.appendix}

Funding for OpenNESS came from the European Community's Seventh Framework Programme (FP7/2007-2013) under grant agreement no 308428, OpenNESS Project (Operationalisation of Natural Capital and Ecosystem Services: From Concepts to Real-world Applications.)

Funding for BioDT came from the European Union's Horizon Europe Research and Innovation Programme under grant agreement No 101057437 (BioDT project, [https://doi.org/10.3030/101057437](https://doi.org/10.3030/101057437))

Funding for SPEAK came from the Natural Environment Research Council – Growing Shoots Partnership and application co-creation bursary. NE/Y005805/1 _Growing Shoots​

## CRediT statement {.appendix}

**To do**: https://www.elsevier.com/en-gb/researcher/author/policies-and-guidelines/credit-author-statement

## Acknowledgements {.appendix}

- Will Bolton contributed to the first version of the code.
- Megan Williams?

We are very grateful to all the partipcants of the SPEAK project which this output is based on including: Alastair Leaver, Alice MacSporran, Brian Cassidy, Chris Pollock, David Giles, Jean Cowie, Joanna Gilliatt, Justyna Olszewska, Laura Taylor, Maddi Bunker, Rebecca MacLennan, S Mayes, Shaila Rao, Steve MacKinnon and Tom Gebbie, Active Stirling. We are equally grateful to an additional 18 partipcants who preferred to remain anonymous. ​


## Correspondence {.appendix}

- `{jand,chan}@ceh.ac.uk` for enquiries related to the BioDT or SPEAK projects, or ongoing and future work.

- `chan@ceh.ac.uk` for enquiries related to the production of input data using QGIS.

- `{joemar,madtig}@ceh.ac.uk` for enquiries related to the code and anything else appearing in the technical supplement and/or developer's report.

​
